(this["webpackJsonppunta-front"]=this["webpackJsonppunta-front"]||[]).push([[0],{137:function(e,t,n){e.exports=n(220)},219:function(e,t,n){},220:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),c=n.n(o),l=n(224),i=n(37),u=n(26),s=n(73),g=n.n(s),m="https://app.puntapiedra.com",f=function(e){return g.a.post("".concat(m,"/auth/token"),e)},p=n(117),d={fetching:!0,info:{},error:{},logged:!!(new p.a).get("id")},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(u.a)({},e,{fetching:!0,info:d.info,error:{}});case"LOGIN_SUCCESS":return Object(u.a)({},e,{fetching:!1});case"LOGIN_ERROR":return Object(u.a)({},e,{fetching:!1,error:t.payload,info:{}});case"SIGNUP":return Object(u.a)({},e,{fetching:!0,info:d.info,error:{}});case"SIGNUP_SUCCESS":return Object(u.a)({},e,{fetching:!1});case"SIGNUP_ERROR":return Object(u.a)({},e,{fetching:!1,error:t.payload,info:{}});case"LOGOUT":return Object(u.a)({},e,{info:d.info,logged:!1});case"CHECK_SESSION":return Object(u.a)({},e,{logged:t.payload.logged,info:t.payload.info,fetching:t.payload.fetching});default:return Object(u.a)({},e)}},h=n(44),O=Object(i.b)((function(e){return{logged:e.user.logged}}),{logout:function(){return function(e){g.a.post("".concat(m,"/auth/logout")),(new p.a).remove("id"),(new p.a).remove("user"),e({type:"LOGOUT"})}}})((function(e){var t=e.logged,n=e.logout;return r.a.createElement(r.a.Fragment,null,t?r.a.createElement(l.a,{className:"navbar-container"},r.a.createElement(h.b,{to:"/"},r.a.createElement("img",{src:"/logo.png",alt:"Logo"})),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(h.b,{to:"/"},"Inicio")),r.a.createElement("li",{onClick:n},"Logout"))):null)})),b=n(95),v=n(19),S=n(58),y=n(81),C=n(226),j=n(225),N=n(56),w=n(228),I=n(229),_=n(230),R=Object(i.b)((function(e){var t=e.user;return{info:t.info,fetching:t.fetching,error:t.error}}),{login:function(e){return function(t){var n;t({type:"LOGIN"}),(n=e,g.a.post("".concat(m,"/auth/login"),n)).then((function(e){var n=e.data;(new p.a).set("id",n.token,{maxAge:86400}),(new p.a).set("user",n.userInfo,{maxAge:86400}),t({type:"LOGIN_SUCCESS"}),t({type:"CHECK_SESSION",payload:{logged:!0,info:n.userInfo,fetching:!1}})})).catch((function(e){return t({type:"LOGIN_ERROR",payload:e.response})}))}}})((function(e){var t=e.history,n=e.info,o=e.fetching,c=e.error,l=e.login,i=Object(a.useState)({}),s=Object(y.a)(i,2),g=s[0],m=s[1],p=function(){return g.email&&/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(g.email.toLowerCase())?g.password?void l(g):C.b.error("Contrase\xf1a incorrecta"):C.b.warning("Ingresa un correo v\xe1lido")},d=function(e){return m(Object(u.a)({},g,Object(S.a)({},e.target.name,e.target.value)))};return Object(a.useEffect)((function(){return 403===c.status?C.b.error("Contrase\xf1a incorrecta"):500===c.status?C.b.error("No pudimos completar tu solicitud"):void(n.name&&(C.b.success("Inicio de sesi\xf3n correcto"),t.push("/app")))}),[n,c]),r.a.createElement("div",{className:"auth-container"},r.a.createElement("div",{className:"language-fixed"},r.a.createElement("p",{onClick:function(){return f({email:g.email})}},"ES"),r.a.createElement("p",null,"EN")),r.a.createElement("div",{className:"auth-logo"},r.a.createElement("img",{src:"/logo.png",alt:"ataho logo"})),r.a.createElement("div",{className:"auth-inputs"},r.a.createElement("h2",null,"Iniciar sesi\xf3n"),r.a.createElement(j.a,{suffix:r.a.createElement(w.a,null),onChange:d,name:"email",placeholder:"Correo"}),r.a.createElement(j.a.Password,{iconRender:function(e){return e?r.a.createElement(I.a,null):r.a.createElement(_.a,null)},onChange:d,onKeyPress:function(e){return"Enter"===e.key&&p()},name:"password",placeholder:"Contrase\xf1a"}),r.a.createElement(N.a,{loading:o,type:"primary",onClick:p},"Entrar"),r.a.createElement(h.b,{style:{color:"white",marginTop:"1rem"},to:"/register"},r.a.createElement("small",null,"Crea una cuenta"))))})),G=Object(i.b)((function(e){var t=e.user;return{error:t.error,info:t.info}}),{signup:function(e){return function(t){var n;t({type:"SIGNUP"}),(n=e,g.a.post("".concat(m,"/auth/signup"),n)).then((function(n){var a=n.data;(new p.a).set("id",a.token,{maxAge:86400}),(new p.a).set("user",a.userInfo,{maxAge:86400}),t({type:"SIGNUP_SUCCESS"}),t({type:"CHECK_SESSION",payload:{logged:!0,info:a.userInfo,fetching:!1}}),f({email:e.email})})).catch((function(e){return t({type:"SIGNUP_ERROR",payload:e.response})}))}}})((function(e){var t=e.error,n=e.info,o=e.signup,c=e.history,l=Object(a.useState)({}),i=Object(y.a)(l,2),s=i[0],g=i[1],m=function(e){g(Object(u.a)({},s,Object(S.a)({},e.target.name,e.target.value)))};return Object(a.useEffect)((function(){if(500===t.status)return C.b.error("Ingresa todos los campos");n.name&&(C.b.success("Inicio de sesi\xf3n correcto"),c.push("/"))}),[t]),r.a.createElement("div",{className:"auth-container"},r.a.createElement("div",{className:"auth-logo"},r.a.createElement("img",{src:"/logo.png",alt:"ataho logo"})),r.a.createElement("div",{className:"auth-inputs"},r.a.createElement("h2",null,"Registro de usuario"),r.a.createElement(j.a,{onChange:m,name:"name",placeholder:"Nombre"}),r.a.createElement(j.a,{onChange:m,name:"email",placeholder:"Correo"}),r.a.createElement(j.a,{onChange:m,name:"password",placeholder:"Contrase\xf1a"}),r.a.createElement(N.a,{type:"primary",onClick:function(){return o(s)}},"Registrar"),r.a.createElement(h.b,{style:{color:"white",marginTop:"1rem"},to:"/"},r.a.createElement("small",null,"Regresar"))))})),k=n(222),L=Object(i.b)((function(e){var t=e.user;return{fetching:t.fetching,name:t.info.name}}),{})((function(e){var t=e.fetching,n=e.name;return r.a.createElement("div",{className:"padding-container home-container"},t?r.a.createElement("div",{className:"spinner-full-page"},r.a.createElement(k.a,{size:"large"})):r.a.createElement("h1",null,"Punta Piedra ",n))})),U=function(e){var t=e.logged,n=e.path,a=e.component,o=Object(b.a)(e,["logged","path","component"]);return t?r.a.createElement(v.b,Object.assign({path:n,component:a},o)):r.a.createElement(v.a,Object.assign({to:"/login"},o))},P=function(e){var t=e.logged,n=e.path,a=e.component,o=Object(b.a)(e,["logged","path","component"]);return t?r.a.createElement(v.a,Object.assign({to:"/"},o)):r.a.createElement(v.b,Object.assign({path:n,component:a},o))},x=Object(i.b)((function(e){return{logged:e.user.logged}}),{checkSession:function(){return function(e){var t=(new p.a).get("id"),n=(new p.a).get("user");if(!t)return e({type:"CHECK_SESSION",payload:{logged:!1,info:{},fetching:!1}});n&&e({type:"CHECK_SESSION",payload:{logged:!0,info:n,fetching:!1}})}}})((function(e){var t=e.logged,n=e.checkSession;return Object(a.useEffect)((function(){n()}),[]),r.a.createElement(v.d,null,r.a.createElement(U,{exact:!0,path:"/",logged:t,component:L}),r.a.createElement(P,{path:"/login",logged:t,component:R}),r.a.createElement(P,{path:"/register",logged:t,component:G}))})),A=n(223),H=A.a.Content;var K=function(){return r.a.createElement(A.a,null,r.a.createElement(O,null),r.a.createElement(H,null,r.a.createElement(x,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var T=n(227),z=n(46),B=n(133),D={language:"ES"},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_LANG":return Object(u.a)({},e,{language:t.payload});default:return Object(u.a)({},e)}},W=Object(z.c)({app:J,user:E}),X=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||z.d,[B.a]),Z=function(){return Object(z.e)(W,z.a.apply(void 0,X))},$=(n(218),n(219),Z()),F=function(){return r.a.createElement(h.a,null,r.a.createElement(K,null))},M=function(){return r.a.createElement(i.a,{store:$},r.a.createElement(F,null))},V=function(){return r.a.createElement(T.a,null,r.a.createElement(M,null))};c.a.render(r.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[137,1,2]]]);
//# sourceMappingURL=main.4329889e.chunk.js.map