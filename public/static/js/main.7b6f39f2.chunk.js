(this["webpackJsonppunta-front"]=this["webpackJsonppunta-front"]||[]).push([[0],{137:function(e,t,n){e.exports=n(220)},219:function(e,t,n){},220:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),c=n.n(o),l=n(224),i=n(37),u=n(26),s=n(73),g=n.n(s),m="https://app.puntapiedra.com/",f=n(117),p={fetching:!0,info:{},error:{},logged:!!(new f.a).get("id")},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(u.a)({},e,{fetching:!0,info:p.info,error:{}});case"LOGIN_SUCCESS":return Object(u.a)({},e,{fetching:!1});case"LOGIN_ERROR":return Object(u.a)({},e,{fetching:!1,error:t.payload,info:{}});case"SIGNUP":return Object(u.a)({},e,{fetching:!0,info:p.info,error:{}});case"SIGNUP_SUCCESS":return Object(u.a)({},e,{fetching:!1});case"SIGNUP_ERROR":return Object(u.a)({},e,{fetching:!1,error:t.payload,info:{}});case"LOGOUT":return Object(u.a)({},e,{info:p.info,logged:!1});case"CHECK_SESSION":return Object(u.a)({},e,{logged:t.payload.logged,info:t.payload.info,fetching:t.payload.fetching});default:return Object(u.a)({},e)}},E=n(44),h=Object(i.b)((function(e){return{logged:e.user.logged}}),{logout:function(){return function(e){g.a.post("".concat(m,"/auth/logout")),(new f.a).remove("id"),(new f.a).remove("user"),e({type:"LOGOUT"})}}})((function(e){var t=e.logged,n=e.logout;return r.a.createElement(r.a.Fragment,null,t?r.a.createElement(l.a,{className:"navbar-container"},r.a.createElement(E.b,{to:"/"},r.a.createElement("img",{src:"/logo.png",alt:"Logo"})),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(E.b,{to:"/"},"Inicio")),r.a.createElement("li",{onClick:n},"Logout"))):null)})),O=n(95),b=n(19),v=n(58),S=n(81),y=n(226),C=n(225),j=n(56),N=n(228),w=n(229),I=n(230),_=Object(i.b)((function(e){var t=e.user;return{info:t.info,fetching:t.fetching,error:t.error}}),{login:function(e){return function(t){var n;t({type:"LOGIN"}),(n=e,g.a.post("".concat(m,"/auth/login"),n)).then((function(e){var n=e.data;(new f.a).set("id",n.token,{maxAge:86400}),(new f.a).set("user",n.userInfo,{maxAge:86400}),t({type:"LOGIN_SUCCESS"}),t({type:"CHECK_SESSION",payload:{logged:!0,info:n.userInfo,fetching:!1}})})).catch((function(e){return t({type:"LOGIN_ERROR",payload:e.response})}))}}})((function(e){var t=e.history,n=e.info,o=e.fetching,c=e.error,l=e.login,i=Object(a.useState)({}),s=Object(S.a)(i,2),g=s[0],m=s[1],f=function(){return g.email&&/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(g.email.toLowerCase())?g.password?void l(g):y.b.error("Contrase\xf1a incorrecta"):y.b.warning("Ingresa un correo v\xe1lido")},p=function(e){return m(Object(u.a)({},g,Object(v.a)({},e.target.name,e.target.value)))};return Object(a.useEffect)((function(){return 403===c.status?y.b.error("Contrase\xf1a incorrecta"):500===c.status?y.b.error("No pudimos completar tu solicitud"):void(n.name&&(y.b.success("Inicio de sesi\xf3n correcto"),t.push("/app")))}),[n,c]),r.a.createElement("div",{className:"auth-container"},r.a.createElement("div",{className:"language-fixed"},r.a.createElement("p",null,"ES"),r.a.createElement("p",null,"EN")),r.a.createElement("div",{className:"auth-logo"},r.a.createElement("img",{src:"/logo.png",alt:"ataho logo"})),r.a.createElement("div",{className:"auth-inputs"},r.a.createElement("h2",null,"Iniciar sesi\xf3n"),r.a.createElement(C.a,{suffix:r.a.createElement(N.a,null),onChange:p,name:"email",placeholder:"Correo"}),r.a.createElement(C.a.Password,{iconRender:function(e){return e?r.a.createElement(w.a,null):r.a.createElement(I.a,null)},onChange:p,onKeyPress:function(e){return"Enter"===e.key&&f()},name:"password",placeholder:"Contrase\xf1a"}),r.a.createElement(j.a,{loading:o,type:"primary",onClick:f},"Entrar"),r.a.createElement(E.b,{style:{color:"white",marginTop:"1rem"},to:"/register"},r.a.createElement("small",null,"Crea una cuenta"))))})),R=Object(i.b)((function(e){var t=e.user;return{error:t.error,info:t.info}}),{signup:function(e){return function(t){var n;t({type:"SIGNUP"}),(n=e,g.a.post("".concat(m,"/auth/signup"),n)).then((function(e){var n=e.data;(new f.a).set("id",n.token,{maxAge:86400}),(new f.a).set("user",n.userInfo,{maxAge:86400}),t({type:"SIGNUP_SUCCESS"}),t({type:"CHECK_SESSION",payload:{logged:!0,info:n.userInfo,fetching:!1}})})).then(function(e){return g.a.post("".concat(m,"/auth/token"),e)}({email:e.email})).catch((function(e){return t({type:"SIGNUP_ERROR",payload:e.response})}))}}})((function(e){var t=e.error,n=e.info,o=e.signup,c=e.history,l=Object(a.useState)({}),i=Object(S.a)(l,2),s=i[0],g=i[1],m=function(e){g(Object(u.a)({},s,Object(v.a)({},e.target.name,e.target.value)))};return Object(a.useEffect)((function(){if(500===t.status)return y.b.error("Ingresa todos los campos");n.name&&(y.b.success("Inicio de sesi\xf3n correcto"),c.push("/"))}),[t]),r.a.createElement("div",{className:"auth-container"},r.a.createElement("div",{className:"auth-logo"},r.a.createElement("img",{src:"/logo.png",alt:"ataho logo"})),r.a.createElement("div",{className:"auth-inputs"},r.a.createElement("h2",null,"Registro de usuario"),r.a.createElement(C.a,{onChange:m,name:"name",placeholder:"Nombre"}),r.a.createElement(C.a,{onChange:m,name:"email",placeholder:"Correo"}),r.a.createElement(C.a,{onChange:m,name:"password",placeholder:"Contrase\xf1a"}),r.a.createElement(j.a,{type:"primary",onClick:function(){return o(s)}},"Registrar"),r.a.createElement(E.b,{style:{color:"white",marginTop:"1rem"},to:"/"},r.a.createElement("small",null,"Regresar"))))})),G=n(222),k=Object(i.b)((function(e){var t=e.user;return{fetching:t.fetching,name:t.info.name}}),{})((function(e){var t=e.fetching,n=e.name;return r.a.createElement("div",{className:"padding-container home-container"},t?r.a.createElement("div",{className:"spinner-full-page"},r.a.createElement(G.a,{size:"large"})):r.a.createElement("h1",null,"Punta Piedra ",n))})),L=function(e){var t=e.logged,n=e.path,a=e.component,o=Object(O.a)(e,["logged","path","component"]);return t?r.a.createElement(b.b,Object.assign({path:n,component:a},o)):r.a.createElement(b.a,Object.assign({to:"/login"},o))},U=function(e){var t=e.logged,n=e.path,a=e.component,o=Object(O.a)(e,["logged","path","component"]);return t?r.a.createElement(b.a,Object.assign({to:"/"},o)):r.a.createElement(b.b,Object.assign({path:n,component:a},o))},P=Object(i.b)((function(e){return{logged:e.user.logged}}),{checkSession:function(){return function(e){var t=(new f.a).get("id"),n=(new f.a).get("user");if(!t)return e({type:"CHECK_SESSION",payload:{logged:!1,info:{},fetching:!1}});n&&e({type:"CHECK_SESSION",payload:{logged:!0,info:n,fetching:!1}})}}})((function(e){var t=e.logged,n=e.checkSession;return Object(a.useEffect)((function(){n()}),[]),r.a.createElement(b.d,null,r.a.createElement(L,{exact:!0,path:"/",logged:t,component:k}),r.a.createElement(U,{path:"/login",logged:t,component:_}),r.a.createElement(U,{path:"/register",logged:t,component:R}))})),x=n(223),A=x.a.Content;var H=function(){return r.a.createElement(x.a,null,r.a.createElement(h,null),r.a.createElement(A,null,r.a.createElement(P,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var K=n(227),T=n(46),z=n(133),B={language:"ES"},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_LANG":return Object(u.a)({},e,{language:t.payload});default:return Object(u.a)({},e)}},J=Object(T.c)({app:D,user:d}),W=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||T.d,[z.a]),X=function(){return Object(T.e)(J,T.a.apply(void 0,W))},Z=(n(218),n(219),X()),$=function(){return r.a.createElement(E.a,null,r.a.createElement(H,null))},F=function(){return r.a.createElement(i.a,{store:Z},r.a.createElement($,null))},M=function(){return r.a.createElement(K.a,null,r.a.createElement(F,null))};c.a.render(r.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[137,1,2]]]);
//# sourceMappingURL=main.7b6f39f2.chunk.js.map